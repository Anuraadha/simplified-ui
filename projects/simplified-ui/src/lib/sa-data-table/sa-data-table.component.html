<div class="mdc-layout-grid">
  <div class="mdc-layout-grid__inner">

    <div fxFlex fxLayout="column" fxLayoutAlign="start strech" fxLayoutGap="8px">

      <div fxFlex fxLayout="row" fxLayoutAlign="start center">
        <div fxFlex="grow">
          <sa-data-filter *ngIf="(dataTable.showFilters == null) || dataTable.showFilters" [filters]="filterArray"
            (filterChange)="filterChange($event)"></sa-data-filter>
        </div>
        <div fxFlex="nogrow">
          <button mat-button *ngIf="dataTable.mainActionMenu.length > 0" color="primary" [matMenuTriggerFor]="menu">
            Action
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item color="primary" *ngFor="let action of dataTable.mainActionMenu"
              (click)="menuItemClicked(action, $event)">
              {{ action.title }}
            </button>
          </mat-menu>
        </div>
        <div fxFlex="nogrow">
          <button mat-button color="primary" [matMenuTriggerFor]="columnMenu">
            Columns <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
          <mat-menu #columnMenu>
            <mat-checkbox class="mat-menu-item" *ngFor="let column of columns"
              (change)="columnChangeClicked($event, column)" [checked]="isColumnVisible(column)"
              (click)="$event.stopPropagation()">
              {{column.title}}
            </mat-checkbox>
          </mat-menu>
        </div>
      </div>

      <div fxFlex fxLayout="column" fxLayoutAlign="start strech">
        <mat-table [dataSource]="tableDataSource" matSort class="mat-elevation-z8">

          <!-- Checkbox Column -->
          <ng-container matColumnDef="select">
            <mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle() : null"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
              </mat-checkbox>
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
              </mat-checkbox>
            </mat-cell>
          </ng-container>

          <!-- button Column -->
          <ng-container matColumnDef="options" stickyEnd>
            <mat-header-cell *matHeaderCellDef>
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
              <ng-container *ngTemplateOutlet="dataTable.optionsColumnRef; context: { $implicit: row }"></ng-container>
            </mat-cell>
          </ng-container>

          <!-- Router Link Column -->
          <ng-container matColumnDef="route">
            <mat-header-cell *matHeaderCellDef>
            </mat-header-cell>
            <mat-cell *matCellDef="let row"><a [routerLink]="[row['route']]"></a></mat-cell>
          </ng-container>

          <!-- Sliced 1 to not to reinitilize the select controller-->
          <ng-container *ngFor="let col of columns" [matColumnDef]="col.key" [sticky]="col.sticky"
            [stickyEnd]="col.stickyEnd">
            <mat-header-cell *matHeaderCellDef mat-sort-header> {{col.title}} </mat-header-cell>
            <mat-cell (click)="dataRowClick(element)" *matCellDef="let element">
              <div *ngIf="col.template; else native;">
                <ng-container *ngTemplateOutlet="col.template; context: { column: col, row: element }"></ng-container>
              </div>
              <ng-template #native>
                {{element[col.key] | valueFormatter: col.type}}
              </ng-template>

            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="columnToDisplay; sticky: true"></mat-header-row>
          <mat-row matRipple *matRowDef="let row; columns: columnToDisplay;"
            [ngStyle]="{'display': !isRender ? 'none' : null}"></mat-row>
        </mat-table>

        <ng-container *ngIf="((tableDataSource?.dataStream | async).length == 0)">
          <div class="blank-card">
            <p>
              There are no items to show currently.
            </p>
          </div>
      </ng-container>
       
        <div *ngIf="!isRender" style="background-color:white;">
          <div fxFlex="row" fxLayoutAlign="space-around" style="padding:8px;">
            <mat-spinner diameter="50"></mat-spinner>
          </div>
        </div>

        <mat-paginator *ngIf="(dataTable.showPaginator == null) || dataTable.showPaginator" class="mat-elevation-z8"
          [pageSizeOptions]="[20, 30, 40, 100]" [length]="totalCount" [pageSize]="tableDataSource.filter.pageSize"
          [pageIndex]="tableDataSource.filter.pageNo" showFirstLastButtons></mat-paginator>
      </div>
    </div>
  </div>
</div>
